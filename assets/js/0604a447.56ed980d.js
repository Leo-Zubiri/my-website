"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[8248],{3905:(e,n,r)=>{r.d(n,{Zo:()=>u,kt:()=>k});var t=r(67294);function a(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function o(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function l(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?o(Object(r),!0).forEach((function(n){a(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function i(e,n){if(null==e)return{};var r,t,a=function(e,n){if(null==e)return{};var r,t,a={},o=Object.keys(e);for(t=0;t<o.length;t++)r=o[t],n.indexOf(r)>=0||(a[r]=e[r]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)r=o[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var s=t.createContext({}),c=function(e){var n=t.useContext(s),r=n;return e&&(r="function"==typeof e?e(n):l(l({},n),e)),r},u=function(e){var n=c(e.components);return t.createElement(s.Provider,{value:n},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},d=t.forwardRef((function(e,n){var r=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),p=c(r),d=a,k=p["".concat(s,".").concat(d)]||p[d]||m[d]||o;return r?t.createElement(k,l(l({ref:n},u),{},{components:r})):t.createElement(k,l({ref:n},u))}));function k(e,n){var r=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=r.length,l=new Array(o);l[0]=d;var i={};for(var s in n)hasOwnProperty.call(n,s)&&(i[s]=n[s]);i.originalType=e,i[p]="string"==typeof e?e:a,l[1]=i;for(var c=2;c<o;c++)l[c]=r[c];return t.createElement.apply(null,l)}return t.createElement.apply(null,r)}d.displayName="MDXCreateElement"},68001:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>s,contentTitle:()=>l,default:()=>m,frontMatter:()=>o,metadata:()=>i,toc:()=>c});var t=r(87462),a=(r(67294),r(3905));const o={},l="CRUD Clientes React",i={unversionedId:"react/CRUD-clientes",id:"react/CRUD-clientes",title:"CRUD Clientes React",description:"---",source:"@site/docs/react/CRUD-clientes.md",sourceDirName:"react",slug:"/react/CRUD-clientes",permalink:"/my-website/docs/react/CRUD-clientes",draft:!1,editUrl:"https://github.com/Leo-Zubiri/my-website/tree/master/docs/react/CRUD-clientes.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"React",permalink:"/my-website/docs/react/"},next:{title:"Cotizador de criptomonedas",permalink:"/my-website/docs/react/CotizaCripto"}},s={},c=[{value:"<strong>React Router</strong>",id:"react-router",level:2},{value:"<strong>useLocation</strong> de ReactRouter",id:"uselocation-de-reactrouter",level:2},{value:"<strong>useNavigate</strong> de ReactRouter",id:"usenavigate-de-reactrouter",level:2},{value:"<strong>useParams</strong> de ReactRouter",id:"useparams-de-reactrouter",level:2},{value:"<strong>Librer\xedas para Formularios</strong>",id:"librer\xedas-para-formularios",level:2},{value:"<strong>Validaci\xf3n con Yup</strong>",id:"validaci\xf3n-con-yup",level:2},{value:"<strong>Para reinicar el formulario al enviar</strong>",id:"para-reinicar-el-formulario-al-enviar",level:3},{value:"<strong>Cargar valores en formulario para editar</strong>",id:"cargar-valores-en-formulario-para-editar",level:3},{value:"<strong>JSON Server</strong>",id:"json-server",level:2},{value:"<strong>POST</strong>",id:"post",level:2},{value:"<strong>GET</strong>",id:"get",level:2},{value:"<strong>PUT</strong>",id:"put",level:2},{value:"<strong>DELETE</strong>",id:"delete",level:2},{value:"<strong>Spinner Cargando...</strong>",id:"spinner-cargando",level:2},{value:"<strong>Publicar la API JSON Server</strong>",id:"publicar-la-api-json-server",level:2},{value:"<strong>Enlazar el server en la nube</strong>",id:"enlazar-el-server-en-la-nube",level:2},{value:"Para producci\xf3n",id:"para-producci\xf3n",level:2}],u={toc:c},p="wrapper";function m(e){let{components:n,...o}=e;return(0,a.kt)(p,(0,t.Z)({},u,o,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"crud-clientes-react"},"CRUD Clientes React"),(0,a.kt)("p",null,(0,a.kt)("img",{src:r(6049).Z,width:"1278",height:"800"}),"\n",(0,a.kt)("img",{src:r(95846).Z,width:"1290",height:"995"})),(0,a.kt)("h2",{id:""},(0,a.kt)("img",{src:r(9419).Z,width:"1289",height:"556"})),(0,a.kt)("h2",{id:"react-router"},(0,a.kt)("strong",{parentName:"h2"},"React Router")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"}," npm i react-router-dom")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"import {BrowserRouter,Routes, Route} from 'react-router-dom';\n\n...\n\n// Desde el componente principal\n    <BrowserRouter>\n      <Routes>\n        <Route>\n          <Route path='/' element={<InicarSesion/>}/>\n\n          {/** Usar Master page, para que siempre aparezca cierto componente en esa ruta */}\n          <Route path='/clientes' element={<Layout/>}> \n            <Route index element={<Inicio />} />\n          </Route>\n        </Route>\n      </Routes>\n    </BrowserRouter>\n\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"// Nuevo componente de React router\nimport {Outlet} from 'react-router-dom'\n\n// En Oulet se inyecta el componente que se cargue en base a las routes anidadas\nconst Layout = () => {\n  return (\n    <div>Layout\n      <Outlet />\n    </div>\n  )\n}\n\nexport default Layout\n")),(0,a.kt)("h2",{id:"uselocation-de-reactrouter"},(0,a.kt)("strong",{parentName:"h2"},"useLocation")," de ReactRouter"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'import {Outlet,Link,useLocation} from \'react-router-dom\'\n\n...\n\n  const location = useLocation();\n// Object { pathname: "/clientes/nuevo", search: "", hash: "", state: null, key: "t6feuoku" }\n\n  const urlActual = location.pathname;\n\n')),(0,a.kt)("h2",{id:"usenavigate-de-reactrouter"},(0,a.kt)("strong",{parentName:"h2"},"useNavigate")," de ReactRouter"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"import { useNavigate } from 'react-router-dom'\n\n...\n\nconst navigate = useNavigate('/clientes') // Redirecciona\n")),(0,a.kt)("h2",{id:"useparams-de-reactrouter"},(0,a.kt)("strong",{parentName:"h2"},"useParams")," de ReactRouter"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"import { useParams } from 'react-router-dom'\n\n...\n\nconst params = useParams() // Obtiene los parametros de la url en un objeto {} params.id\n")),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"librer\xedas-para-formularios"},(0,a.kt)("strong",{parentName:"h2"},"Librer\xedas para Formularios")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Formik con herramienta de validaci\xf3n Yup",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"}," npm i formik")))),(0,a.kt)("li",{parentName:"ul"},"Yup ",(0,a.kt)("a",{parentName:"li",href:"https://www.npmjs.com/package/yup"},"documentaci\xf3n>>>"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"}," npm i yup")))),(0,a.kt)("li",{parentName:"ul"},"React Hook Form")),(0,a.kt)("br",null),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Formik")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"import { Formik, Form, Field, ErrorMessage } from 'formik'\n\n...\n\n <Formik\n    initialValues={{\n      nombre:''\n    }}\n    onSubmit={(values) => { console.log('Enviando',values)}}\n >\n    {({errors,touched}) => {\n\n      return (<Form>\n\n          <div>\n              <label htmlFor='nombre'>Nombre: </label>\n              <Field \n                  id='nombre'\n                  type='password'\n                  className=''\n                  placeholder=''\n                  name='nombre'\n              />\n\n              {/*Posible forma de mostrar error*/}\n              <ErrorMessage name='nombre'/>\n\n              {/* Forma incluso para validar en tiempo real sin enviar, al salir del input*/}\n              {errors.nombre && touched.nombre ? (\n                  <div> {errors.nombre} </div>\n                ): null\n              }\n          </div>\n          \n      </Form>)\n      }}\n</Formik>\n")),(0,a.kt)("h2",{id:"validaci\xf3n-con-yup"},(0,a.kt)("strong",{parentName:"h2"},"Validaci\xf3n con Yup")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"import * as Yup from 'yup'\n\n...\n\nconst nuevoSchema = Yup.object().shape({\n  nombre: Yup.string()\n          .min(3,'Demasiado corto')\n          .max(20,'too long')\n          .required('El nombre es obligatorio'),\n})\n\n <Formik\n    initialValues={{ nombre:'' }}\n    onSubmit={handleSubmit}\n    validationSchema={nuevoSchema}\n >\n ...\n\n </Formik>\n")),(0,a.kt)("h3",{id:"para-reinicar-el-formulario-al-enviar"},(0,a.kt)("strong",{parentName:"h3"},"Para reinicar el formulario al enviar")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"<Formik\n    initialValues={{\n        nombre:'',\n        empresa:'',\n        email:'',\n        telefono:'',\n        notas:'',\n    }}\n\n    onSubmit={async (values,{resetForm}) => {\n        await handleSubmit(values);\n        resetForm();\n    }}\n    validationSchema={nuevoClienteSchema}\n>\n")),(0,a.kt)("br",null),(0,a.kt)("hr",null),(0,a.kt)("h3",{id:"cargar-valores-en-formulario-para-editar"},(0,a.kt)("strong",{parentName:"h3"},"Cargar valores en formulario para editar")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Nullish_coalescing_operator"},"Nullish coalescing operator (??)")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'<Formik\n  initialValues={{\n      // Pregunta si cliente existe y tiene la propiedad nombre si es undefined ?? entonces\n      nombre: cliente?.nombre ?? "", ...\n  }}\n\n  // Habilita el renderizado por si datos tardan en llegar\n  enableReinitialize={true}\n\n  ...\n\nFormulario.defaultProps = {\n    cliente:{}\n}\n\nexport default Formulario\n')),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"json-server"},(0,a.kt)("strong",{parentName:"h2"},"JSON Server")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"REST - Representational State transfer"),(0,a.kt)("li",{parentName:"ul"},"API - Application programmin interface")),(0,a.kt)("p",null,"Con JSON Server puedes simular la entrada de informaci\xf3n para desarrollar el frontend sin la necesidad de que el backend ya se encuentre listo. Act\xfaa como una API real."),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/json-server"},(0,a.kt)("strong",{parentName:"a"},"Instalaci\xf3n JSON server"))),(0,a.kt)("p",null,"Con privilegios de administrador:\n",(0,a.kt)("inlineCode",{parentName:"p"},"npm install -g json-server")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Crear un archivo en la raiz del proyecto llamado ",(0,a.kt)("strong",{parentName:"li"},"db.json"),", aqui colocar los atributos llave valor")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"// Para ejecutar el archivo en JSON Server\n\njson-server --watch db.json --port 4000\n\n// En este caso la informacion se encuentra en localhost:4000/clientes, depende de las llaves en el archivo json\n")),(0,a.kt)("h2",{id:"post"},(0,a.kt)("strong",{parentName:"h2"},"POST")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"const handleSubmit = async (values) => { \n    try{\n        const url = 'http:/localhost:4000/clientes'\n\n        const response = await fetch(url,{\n            method: 'POST',\n            body: JSON.stringify(values),\n            // En el caso de JSON SERVER:\n            headers: {\n                'Content-Type': 'application/json'\n            }\n        });\n\n        const result = await response.json(); //Retorna el objeto que agreg\xf3\n\n    } catch(error){console.log(error)}\n}\n\n")),(0,a.kt)("h2",{id:"get"},(0,a.kt)("strong",{parentName:"h2"},"GET")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"const obtenerClientesAPI = async () => { \n  try {\n    const url = 'http://localhost:4000/clientes'\n    const response = await fetch(url);\n    const result = await response.json();\n    \n  } catch (error) {\n    console.log(error);\n  }\n}\n")),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"put"},(0,a.kt)("strong",{parentName:"h2"},"PUT")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-JS"},"const url = `http://localhost:4000/clientes/${cliente.id}`\nconst response = await fetch(url,{\n    method: 'PUT',\n    body: JSON.stringify(values),\n    headers: {\n        'Content-Type': 'application/json'\n    }\n});\n\nconst result = response.json();\n")),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"delete"},(0,a.kt)("strong",{parentName:"h2"},"DELETE")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"const url = `http://localhost:4000/clientes/${id}`;\nconst response = await fetch(url, {\n  method: 'DELETE'\n});\n\nawait response.json();\n")),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"spinner-cargando"},(0,a.kt)("strong",{parentName:"h2"},"Spinner Cargando...")),(0,a.kt)("p",null,"Elegir el spinner deseado\n",(0,a.kt)("a",{parentName:"p",href:"https://tobiasahlin.com/spinkit/"},"Spinkit ---\x3e")),(0,a.kt)("p",null,"Crear un componente y enlazar los estilos."),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"publicar-la-api-json-server"},(0,a.kt)("strong",{parentName:"h2"},"Publicar la API JSON Server")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Subir el proyecto a github"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://my-json-server.typicode.com/"},"Pagina My JSON Server")),(0,a.kt)("li",{parentName:"ul"},"Pegar al link de My Json Server el repo del proyecto junto con el nombre de usario. Adem\xe1s el endpoint:")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("a",{parentName:"p",href:"https://my-json-server.typicode.com/Leo-Zubiri/CRUD-Clientes-REACT/clientes"},"https://my-json-server.typicode.com/Leo-Zubiri/CRUD-Clientes-REACT/clientes"))),(0,a.kt)("p",null,"Con lo anterior se debe visualizar nuestra API JSON con los datos que vamos agregando. "),(0,a.kt)("br",null),(0,a.kt)("h2",{id:"enlazar-el-server-en-la-nube"},(0,a.kt)("strong",{parentName:"h2"},"Enlazar el server en la nube")),(0,a.kt)("p",null,"Se deben crear variables de entorno para indicar que localmente apunte a localhost y en producci\xf3n apunte a la nube"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://vitejs.dev/guide/env-and-mode.html"},"Variables de Entorno en Vite")),(0,a.kt)("p",null,"En este caso:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Crear archivo .env.development.local y env.production.local en la raiz del proyecto"),(0,a.kt)("li",{parentName:"ol"},"Agregar variables con la sintaxis ",(0,a.kt)("strong",{parentName:"li"},"VITE_")," variable=123"),(0,a.kt)("li",{parentName:"ol"},"Para importar las variables de entorno ",(0,a.kt)("strong",{parentName:"li"},"import.meta.env"))),(0,a.kt)("h2",{id:"para-producci\xf3n"},"Para producci\xf3n"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"npm run build"),"\n",(0,a.kt)("inlineCode",{parentName:"p"},"npm run preview"),"  Para visualizar la build de distribuci\xf3n"),(0,a.kt)("p",null,"En el archivo de production:\n",(0,a.kt)("inlineCode",{parentName:"p"},"VITE_API_URL=https://my-json-server.typicode.com/Leo-Zubiri/CRUD-Clientes-REACT/clientes")),(0,a.kt)("p",null,"En el archivo de development:\n",(0,a.kt)("inlineCode",{parentName:"p"},"VITE_API_URL=http://localhost:4000/clientes")),(0,a.kt)("p",null,"Sustituir los valores de la API en todas las referencias: "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"const api_url = import.meta.env.VITE_API_URL\n")))}m.isMDXComponent=!0},6049:(e,n,r)=>{r.d(n,{Z:()=>t});const t=r.p+"assets/images/final1-fa43386d445fb9a3ac18eac55779c2b0.png"},95846:(e,n,r)=>{r.d(n,{Z:()=>t});const t=r.p+"assets/images/final2-eb78c75bb1eeeb7368bd76768fcaf19f.png"},9419:(e,n,r)=>{r.d(n,{Z:()=>t});const t=r.p+"assets/images/final3-dac20399b20d3e4c03034da4d8be30c5.png"}}]);